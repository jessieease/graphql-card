{"ast":null,"code":"\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar redux_immutable_1 = require(\"redux-immutable\");\n\nvar reducers_1 = require(\"../docs/reducers\");\n\nvar reducers_2 = require(\"../sessions/reducers\");\n\nvar reducers_3 = require(\"../sharing/reducers\");\n\nvar reducers_4 = require(\"../history/reducers\");\n\nvar immutable_1 = require(\"immutable\");\n\nvar reducers_5 = require(\"../general/reducers\");\n\nvar immutableMemoize_1 = require(\"../../components/Playground/util/immutableMemoize\");\n\nvar reselect_1 = require(\"reselect\");\n\nvar deserialize_1 = require(\"./deserialize\");\n\nvar reducers_6 = require(\"../appHistory/reducers\");\n\nfunction getSelectedWorkspaceId(state) {\n  return state.get('selectedWorkspace');\n}\n\nexports.getSelectedWorkspaceId = getSelectedWorkspaceId;\n\nfunction getSelectedWorkspace(state) {\n  return state.getIn(['workspaces', getSelectedWorkspaceId(state)]);\n}\n\nexports.getSelectedWorkspace = getSelectedWorkspace;\n\nvar Workspace =\n/** @class */\nfunction (_super) {\n  __extends(Workspace, _super);\n\n  function Workspace() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Workspace;\n}(immutable_1.Record({\n  docs: immutable_1.Map({}),\n  sessions: reducers_2.makeSessionState(''),\n  sharing: new reducers_3.SharingState(),\n  history: immutable_1.OrderedMap()\n}));\n\nexports.Workspace = Workspace;\nexports.defaultSettings = {\n  'editor.cursorShape': 'line',\n  'editor.fontFamily': \"'Source Code Pro', 'Consolas', 'Inconsolata', 'Droid Sans Mono', 'Monaco', monospace\",\n  'editor.fontSize': 14,\n  'editor.reuseHeaders': true,\n  'editor.theme': 'dark',\n  'general.betaUpdates': false,\n  'prettier.printWidth': 80,\n  'prettier.tabWidth': 2,\n  'prettier.useTabs': false,\n  'request.credentials': 'omit',\n  'request.globalHeaders': {},\n  'schema.disableComments': true,\n  'schema.polling.enable': true,\n  'schema.polling.endpointFilter': '*localhost*',\n  'schema.polling.interval': 2000,\n  'tracing.hideTracingResponse': true,\n  'tracing.tracingSupported': true\n}; // tslint:disable-next-line:max-classes-per-file\n\nvar RootState =\n/** @class */\nfunction (_super) {\n  __extends(RootState, _super);\n\n  function RootState() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return RootState;\n}(immutable_1.Record({\n  workspaces: immutable_1.Map({\n    '': makeWorkspace('')\n  }),\n  selectedWorkspace: '',\n  settingsString: JSON.stringify(exports.defaultSettings, null, 2),\n  stateInjected: false,\n  appHistory: new reducers_6.AppHistory(),\n  general: new reducers_5.GeneralState()\n}));\n\nexports.RootState = RootState;\nvar workspaceReducers = redux_immutable_1.combineReducers({\n  docs: reducers_1[\"default\"],\n  sessions: reducers_2[\"default\"],\n  sharing: reducers_3[\"default\"],\n  history: reducers_4[\"default\"],\n  general: reducers_5[\"default\"],\n  appHistory: reducers_6[\"default\"]\n}); // todo: add lru-cache later when the localStorage is full\n\nexports.rootReducer = function (state, action) {\n  if (state === void 0) {\n    state = new RootState();\n  }\n\n  if (action.type === 'SELECT_WORKSPACE') {\n    return state.set('selectedWorkspace', action.payload.workspace);\n  }\n\n  if (action.type === 'SET_SETTINGS_STRING') {\n    return state.set('settingsString', action.payload.settingsString);\n  }\n\n  if (action.type === 'INIT_STATE' && !state.stateInjected) {\n    var _a = action.payload,\n        workspaceId = _a.workspaceId,\n        endpoint = _a.endpoint;\n\n    if (!state.workspaces.get(workspaceId)) {\n      var newState = state.setIn(['workspaces', workspaceId], makeWorkspace(endpoint));\n      return newState.set('selectedWorkspace', workspaceId);\n    }\n\n    return state.set('selectedWorkspace', workspaceId);\n  }\n\n  if (action.type === 'INJECT_STATE') {\n    return deserialize_1.deserializePersistedState(action.payload.state).set('stateInjected', true);\n  }\n\n  if (action.type === 'INJECT_TABS') {\n    return makeStateFromTabs(action.payload.tabs);\n  }\n\n  if (action.type === 'SELECT_APP_HISTORY_ITEM') {\n    return state.set('appHistory', reducers_6[\"default\"](state.appHistory, action));\n  }\n\n  var generalActions = {\n    OPEN_HISTORY: true,\n    CLOSE_HISTORY: true,\n    SET_ENDPOINT_DISABLED: true,\n    SET_CONFIG_STRING: true\n  };\n\n  if (generalActions[action.type]) {\n    return state.set('general', reducers_5[\"default\"](state.general, action));\n  }\n\n  var selectedWorkspaceId = action.payload && action.payload.workspaceId ? action.payload.workspaceId : getSelectedWorkspaceId(state);\n  var path = ['workspaces', selectedWorkspaceId];\n  return state.setIn(path, workspaceReducers(state.getIn(path), action));\n};\n\nfunction makeStateFromTabs(tabs) {\n  var endpoint = tabs[0].endpoint;\n  var tabSessions = immutable_1.OrderedMap(tabs.map(reducers_2.sessionFromTab).reduce(function (acc, curr) {\n    var _a;\n\n    return __assign(__assign({}, acc), (_a = {}, _a[curr.id] = curr, _a));\n  }, {})); // @ts-ignore\n\n  var selectedSessionId = tabSessions.first().id;\n  var workspace = makeWorkspace(endpoint).setIn(['sessions', 'sessions'], tabSessions).setIn(['sessions', 'selectedSessionId'], selectedSessionId);\n  return new RootState().setIn(['workspaces', endpoint], workspace).set('selectedWorkspace', endpoint);\n}\n\nfunction makeWorkspace(endpoint) {\n  var _a;\n\n  var sessionState = reducers_2.makeSessionState(endpoint); // weird typescript error\n\n  return new Workspace({\n    docs: immutable_1.Map((_a = {}, _a[sessionState.selectedSessionId] = new reducers_1.DocsSession(), _a)),\n    sessions: sessionState,\n    sharing: new reducers_3.SharingState(),\n    history: immutable_1.OrderedMap()\n  });\n}\n\nexports.makeWorkspace = makeWorkspace;\nexports[\"default\"] = exports.rootReducer;\nexports.getSessionCounts = immutableMemoize_1.immutableMemoize(function (state) {\n  return state.workspaces.map(function (w) {\n    return w.sessions.sessionCount;\n  });\n});\n\nexports.getSettingsString = function (state) {\n  return state.settingsString;\n};\n\nexports.getSettings = reselect_1.createSelector([exports.getSettingsString], parseSettingsString);\n\nfunction normalizeSettings(settings) {\n  var theme = settings['editor.theme'];\n\n  if (theme !== 'dark' && theme !== 'light') {\n    settings['editor.theme'] = 'dark';\n  }\n\n  return __assign(__assign({}, exports.defaultSettings), settings);\n}\n\nfunction parseSettingsString(settingsString) {\n  try {\n    return normalizeSettings(JSON.parse(settingsString));\n  } catch (e) {\n    return exports.defaultSettings;\n  }\n}\n\nfunction normalizeSettingsString(settingsString) {\n  return JSON.stringify(parseSettingsString(settingsString), null, 2);\n}\n\nexports.normalizeSettingsString = normalizeSettingsString;\n\nexports.getTheme = function (state, customSettings) {\n  var settings = customSettings || exports.getSettings(state);\n  return settings['editor.theme'] || 'dark';\n};","map":{"version":3,"sources":["/Users/wubo/Desktop/card-design/card-design/node_modules/graphql-playground-react/lib/state/workspace/reducers.js"],"names":["__extends","_extendStatics","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","defineProperty","exports","value","redux_immutable_1","require","reducers_1","reducers_2","reducers_3","reducers_4","immutable_1","reducers_5","immutableMemoize_1","reselect_1","deserialize_1","reducers_6","getSelectedWorkspaceId","state","get","getSelectedWorkspace","getIn","Workspace","_super","Record","docs","Map","sessions","makeSessionState","sharing","SharingState","history","OrderedMap","defaultSettings","RootState","workspaces","makeWorkspace","selectedWorkspace","settingsString","JSON","stringify","stateInjected","appHistory","AppHistory","general","GeneralState","workspaceReducers","combineReducers","rootReducer","action","type","set","payload","workspace","_a","workspaceId","endpoint","newState","setIn","deserializePersistedState","makeStateFromTabs","tabs","generalActions","OPEN_HISTORY","CLOSE_HISTORY","SET_ENDPOINT_DISABLED","SET_CONFIG_STRING","selectedWorkspaceId","path","tabSessions","map","sessionFromTab","reduce","acc","curr","id","selectedSessionId","first","sessionState","DocsSession","getSessionCounts","immutableMemoize","w","sessionCount","getSettingsString","getSettings","createSelector","parseSettingsString","normalizeSettings","settings","theme","parse","e","normalizeSettingsString","getTheme","customSettings"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = void 0 && (void 0).__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar redux_immutable_1 = require(\"redux-immutable\");\n\nvar reducers_1 = require(\"../docs/reducers\");\n\nvar reducers_2 = require(\"../sessions/reducers\");\n\nvar reducers_3 = require(\"../sharing/reducers\");\n\nvar reducers_4 = require(\"../history/reducers\");\n\nvar immutable_1 = require(\"immutable\");\n\nvar reducers_5 = require(\"../general/reducers\");\n\nvar immutableMemoize_1 = require(\"../../components/Playground/util/immutableMemoize\");\n\nvar reselect_1 = require(\"reselect\");\n\nvar deserialize_1 = require(\"./deserialize\");\n\nvar reducers_6 = require(\"../appHistory/reducers\");\n\nfunction getSelectedWorkspaceId(state) {\n  return state.get('selectedWorkspace');\n}\n\nexports.getSelectedWorkspaceId = getSelectedWorkspaceId;\n\nfunction getSelectedWorkspace(state) {\n  return state.getIn(['workspaces', getSelectedWorkspaceId(state)]);\n}\n\nexports.getSelectedWorkspace = getSelectedWorkspace;\n\nvar Workspace =\n/** @class */\nfunction (_super) {\n  __extends(Workspace, _super);\n\n  function Workspace() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Workspace;\n}(immutable_1.Record({\n  docs: immutable_1.Map({}),\n  sessions: reducers_2.makeSessionState(''),\n  sharing: new reducers_3.SharingState(),\n  history: immutable_1.OrderedMap()\n}));\n\nexports.Workspace = Workspace;\nexports.defaultSettings = {\n  'editor.cursorShape': 'line',\n  'editor.fontFamily': \"'Source Code Pro', 'Consolas', 'Inconsolata', 'Droid Sans Mono', 'Monaco', monospace\",\n  'editor.fontSize': 14,\n  'editor.reuseHeaders': true,\n  'editor.theme': 'dark',\n  'general.betaUpdates': false,\n  'prettier.printWidth': 80,\n  'prettier.tabWidth': 2,\n  'prettier.useTabs': false,\n  'request.credentials': 'omit',\n  'request.globalHeaders': {},\n  'schema.disableComments': true,\n  'schema.polling.enable': true,\n  'schema.polling.endpointFilter': '*localhost*',\n  'schema.polling.interval': 2000,\n  'tracing.hideTracingResponse': true,\n  'tracing.tracingSupported': true\n}; // tslint:disable-next-line:max-classes-per-file\n\nvar RootState =\n/** @class */\nfunction (_super) {\n  __extends(RootState, _super);\n\n  function RootState() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return RootState;\n}(immutable_1.Record({\n  workspaces: immutable_1.Map({\n    '': makeWorkspace('')\n  }),\n  selectedWorkspace: '',\n  settingsString: JSON.stringify(exports.defaultSettings, null, 2),\n  stateInjected: false,\n  appHistory: new reducers_6.AppHistory(),\n  general: new reducers_5.GeneralState()\n}));\n\nexports.RootState = RootState;\nvar workspaceReducers = redux_immutable_1.combineReducers({\n  docs: reducers_1[\"default\"],\n  sessions: reducers_2[\"default\"],\n  sharing: reducers_3[\"default\"],\n  history: reducers_4[\"default\"],\n  general: reducers_5[\"default\"],\n  appHistory: reducers_6[\"default\"]\n}); // todo: add lru-cache later when the localStorage is full\n\nexports.rootReducer = function (state, action) {\n  if (state === void 0) {\n    state = new RootState();\n  }\n\n  if (action.type === 'SELECT_WORKSPACE') {\n    return state.set('selectedWorkspace', action.payload.workspace);\n  }\n\n  if (action.type === 'SET_SETTINGS_STRING') {\n    return state.set('settingsString', action.payload.settingsString);\n  }\n\n  if (action.type === 'INIT_STATE' && !state.stateInjected) {\n    var _a = action.payload,\n        workspaceId = _a.workspaceId,\n        endpoint = _a.endpoint;\n\n    if (!state.workspaces.get(workspaceId)) {\n      var newState = state.setIn(['workspaces', workspaceId], makeWorkspace(endpoint));\n      return newState.set('selectedWorkspace', workspaceId);\n    }\n\n    return state.set('selectedWorkspace', workspaceId);\n  }\n\n  if (action.type === 'INJECT_STATE') {\n    return deserialize_1.deserializePersistedState(action.payload.state).set('stateInjected', true);\n  }\n\n  if (action.type === 'INJECT_TABS') {\n    return makeStateFromTabs(action.payload.tabs);\n  }\n\n  if (action.type === 'SELECT_APP_HISTORY_ITEM') {\n    return state.set('appHistory', reducers_6[\"default\"](state.appHistory, action));\n  }\n\n  var generalActions = {\n    OPEN_HISTORY: true,\n    CLOSE_HISTORY: true,\n    SET_ENDPOINT_DISABLED: true,\n    SET_CONFIG_STRING: true\n  };\n\n  if (generalActions[action.type]) {\n    return state.set('general', reducers_5[\"default\"](state.general, action));\n  }\n\n  var selectedWorkspaceId = action.payload && action.payload.workspaceId ? action.payload.workspaceId : getSelectedWorkspaceId(state);\n  var path = ['workspaces', selectedWorkspaceId];\n  return state.setIn(path, workspaceReducers(state.getIn(path), action));\n};\n\nfunction makeStateFromTabs(tabs) {\n  var endpoint = tabs[0].endpoint;\n  var tabSessions = immutable_1.OrderedMap(tabs.map(reducers_2.sessionFromTab).reduce(function (acc, curr) {\n    var _a;\n\n    return __assign(__assign({}, acc), (_a = {}, _a[curr.id] = curr, _a));\n  }, {})); // @ts-ignore\n\n  var selectedSessionId = tabSessions.first().id;\n  var workspace = makeWorkspace(endpoint).setIn(['sessions', 'sessions'], tabSessions).setIn(['sessions', 'selectedSessionId'], selectedSessionId);\n  return new RootState().setIn(['workspaces', endpoint], workspace).set('selectedWorkspace', endpoint);\n}\n\nfunction makeWorkspace(endpoint) {\n  var _a;\n\n  var sessionState = reducers_2.makeSessionState(endpoint); // weird typescript error\n\n  return new Workspace({\n    docs: immutable_1.Map((_a = {}, _a[sessionState.selectedSessionId] = new reducers_1.DocsSession(), _a)),\n    sessions: sessionState,\n    sharing: new reducers_3.SharingState(),\n    history: immutable_1.OrderedMap()\n  });\n}\n\nexports.makeWorkspace = makeWorkspace;\nexports[\"default\"] = exports.rootReducer;\nexports.getSessionCounts = immutableMemoize_1.immutableMemoize(function (state) {\n  return state.workspaces.map(function (w) {\n    return w.sessions.sessionCount;\n  });\n});\n\nexports.getSettingsString = function (state) {\n  return state.settingsString;\n};\n\nexports.getSettings = reselect_1.createSelector([exports.getSettingsString], parseSettingsString);\n\nfunction normalizeSettings(settings) {\n  var theme = settings['editor.theme'];\n\n  if (theme !== 'dark' && theme !== 'light') {\n    settings['editor.theme'] = 'dark';\n  }\n\n  return __assign(__assign({}, exports.defaultSettings), settings);\n}\n\nfunction parseSettingsString(settingsString) {\n  try {\n    return normalizeSettings(JSON.parse(settingsString));\n  } catch (e) {\n    return exports.defaultSettings;\n  }\n}\n\nfunction normalizeSettingsString(settingsString) {\n  return JSON.stringify(parseSettingsString(settingsString), null, 2);\n}\n\nexports.normalizeSettingsString = normalizeSettingsString;\n\nexports.getTheme = function (state, customSettings) {\n  var settings = customSettings || exports.getSettings(state);\n  return settings['editor.theme'] || 'dark';\n};"]},"metadata":{},"sourceType":"script"}